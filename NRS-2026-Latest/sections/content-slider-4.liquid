{% comment %}
  Section: Content Slider 3
  - Improved responsiveness and modularity
  - Simplified video handling
  - Always initializes slider, even for a single block
{% endcomment %}

{%- liquid
  assign section_height = section.settings.section_height | default: '50vh'
  assign section_width = section.settings.section_width | default: 'container'
-%}

<style>
  .content-slider-section-{{ section.id }} {
    position: relative;
    width: 100%;
    height: {{ section_height }};
    overflow: hidden;
  }

  .content-slider-section-{{ section.id }} .slider-container {
    display: flex;
    flex-wrap: nowrap;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
  }

  .content-slider-section-{{ section.id }} .slide-item {
    flex: 0 0 100%;
    scroll-snap-align: start;
    position: relative;
  }

  .content-slider-section-{{ section.id }} .slide-content {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
  }

  .content-slider-section-{{ section.id }} .video-slide-content iframe {
    width: 100%;
    height: 100%;
  }
</style>

<section class="content-slider-section-{{ section.id }}">
  <div class="slider-container">
    {%- for block in section.blocks -%}
      <div class="slide-item">
        <div class="slide-content">
          {%- case block.type -%}
            {%- when 'image_slide' -%}
              <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}">
            {%- when 'video_slide' -%}
              <iframe src="{{ block.settings.video_url }}" frameborder="0" allowfullscreen></iframe>
            {%- when 'mixed_content_slide' -%}
              <div>
                <img src="{{ block.settings.image | image_url }}" alt="{{ block.settings.image.alt }}">
                <p>{{ block.settings.text_content }}</p>
              </div>
          {%- endcase -%}
        </div>
      </div>
    {%- endfor -%}
  </div>
</section>

{% schema %}
{
  "name": "Content Slider 4",
  "settings": [
    {
      "type": "text",
      "id": "section_height",
      "label": "Section Height",
      "default": "50vh"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Section Width",
      "options": [
        { "value": "container", "label": "Container" },
        { "value": "full-width", "label": "Full Width" }
      ],
      "default": "container"
    }
  ],
  "blocks": [
    {
      "type": "image_slide",
      "name": "Image Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" }
      ]
    },
    {
      "type": "video_slide",
      "name": "Video Slide",
      "settings": [
        { "type": "url", "id": "video_url", "label": "Video URL" }
      ]
    },
    {
      "type": "mixed_content_slide",
      "name": "Mixed Content Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "text", "id": "text_content", "label": "Text Content" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Content Slider 4"
    }
  ]
}
{% endschema %}